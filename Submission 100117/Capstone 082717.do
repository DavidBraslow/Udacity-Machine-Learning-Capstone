use "C:\Users\david_000\Google Drive\HSLS_2009_v3_0_Stata_Datasets\hsls_09_student_v3_0.dta", clear
keep if X1POVERTY185 == 1
drop if S3FIELD_STEM < 0 & S3FIELD_STEM != -7

foreach var of varlist S3CLASSES S3CLGFT S3FIELD_STEM {
  replace `var' = . if `var' < 0
  tab `var'
}
replace S3CLGFT = . if S3CLGFT == 3

*The inputs of interest will be credits earned in various specific STEM courses, total credit earnings in various STEM disciplines (e.g. math, biology, engineering), and GPA in various STEM disciplines.

*Grade 8
foreach var of varlist S1M8 S1M8GRADE S1S8 S1S8GRADE {
  replace `var' = . if `var' < 0
  tab `var', plot

} 
replace S1M8GRADE = . if S1M8GRADE == 6
replace S1S8GRADE = . if S1S8GRADE == 6

foreach var of varlist S1ALG1M09 S1GEOM09 S1ALG2M09 S1TRIGM09 S1REVM09 S1INTGM109 S1STATSM09 S1INTGM209 S1PREALGM09 S1ANGEOM09 S1ADVM09 S1OTHM09  {
  replace `var' = . if `var' < 0
} 
summ S1ALG1M09 S1GEOM09 S1ALG2M09 S1TRIGM09 S1REVM09 S1INTGM109 S1STATSM09 S1INTGM209 S1PREALGM09 S1ANGEOM09 S1ADVM09 S1OTHM09, sep(100)


foreach var of varlist S1BIO1S09 S1EARTHS09 S1PHYSS09 S1ENVS09 S1PHYSIC1S09 S1INTGS1S09 S1CHEM1S09 S1INTGS2S09 S1ADVBIOS09 S1GENS09 S1LIFES09 S1ADVPHYSIC09 S1OTHENVS09 S1OTHBIOS09 S1OTHPHYS09 S1OTHS09 {
  replace `var' = . if `var' < 0
} 
summ S1BIO1S09 S1EARTHS09 S1PHYSS09 S1ENVS09 S1PHYSIC1S09 S1INTGS1S09 S1CHEM1S09 S1INTGS2S09 S1ADVBIOS09 S1GENS09 S1LIFES09 S1ADVPHYSIC09 S1OTHENVS09 S1OTHBIOS09 S1OTHPHYS09 S1OTHS09, sep(100)


foreach var of varlist S2PREALGM12 S2ALG1M12 S2ALG2M12 S2ALG3M12 S2GEOM12 S2ANGEOM12 S2TRIGM12 S2PRECALC12 S2APCALC12 S2CALC12 S2APSTAT12 S2STAT12 S2INTGM112 S2INTGM212 S2INTGM312 S2REVIEWM12 S2HIMATH12 S2LIFES12 S2BIO1S12 S2BIO2S12 S2APBIOS12 S2IBIOS12 S2ANATOMYS12 S2OTHBIOS12 S2CHEM1S12 S2CHEM2S12 S2APCHEM12 S2IBCHEM12 S2EARTHS12 S2APENVS12 S2OTHENVS12 S2PHYSIC1S12 S2PHYSIC2S12 S2APPHYSIC12 S2IBPHYSIC12 S2PHYSS12 S2OTHPHYS12 S2INTGS1S12 S2INTGS2S12 S2GENS12 S2COMPAPP12 S2COMPPROG12 S2APCOMPSCI12 S2OTHCOMP12 S2ENGINEER12 S2HISCIENCE12 {
  replace `var' = . if `var' < 0
} 
summ S2PREALGM12 S2ALG1M12 S2ALG2M12 S2ALG3M12 S2GEOM12 S2ANGEOM12 S2TRIGM12 S2PRECALC12 S2APCALC12 S2CALC12 S2APSTAT12 S2STAT12 S2INTGM112 S2INTGM212 S2INTGM312 S2REVIEWM12 S2LIFES12 S2BIO1S12 S2BIO2S12 S2APBIOS12 S2IBIOS12 S2ANATOMYS12 S2OTHBIOS12 S2CHEM1S12 S2CHEM2S12 S2APCHEM12 S2IBCHEM12 S2EARTHS12 S2APENVS12 S2OTHENVS12 S2PHYSIC1S12 S2PHYSIC2S12 S2APPHYSIC12 S2IBPHYSIC12 S2PHYSS12 S2OTHPHYS12 S2INTGS1S12 S2INTGS2S12 S2GENS12 S2COMPAPP12 S2COMPPROG12 S2APCOMPSCI12 S2OTHCOMP12 S2ENGINEER12, sep(100)
tab1 S2HIMATH12 S2HISCIENCE12

foreach var of varlist X3THIMATH X3THIMATH9 X3TWHENALG1 X3THISCI X3THISCI9 X3THIBIO X3THICHEM X3THIPHY X3THIOTHSCI  {
  replace `var' = . if `var' < 0
} 
tab1 X3THIMATH X3THIMATH9 X3TWHENALG1 X3THISCI X3THISCI9 X3THIBIO X3THICHEM X3THIPHY X3THIOTHSCI 

replace X3TWHENALG1 = . if X3TWHENALG1 == 8
replace X3TWHENALG1 = 3 if X3TWHENALG1 == 10

foreach var of varlist S2APMATH S2APSCIENCE S2IBMATH S2IBSCIENCE S2DUALMATH S2DUALSCIENCE {
  replace `var' = . if `var' < 0
} 
summ S2APMATH S2APSCIENCE S2IBMATH S2IBSCIENCE S2DUALMATH S2DUALSCIENCE, sep(100)


*Credits
foreach var of varlist X3T1CREDALG1 X3T1CREDALG2 X3T1CREDINTM X3T1CREDPREC X3T1CREDCALC X3T1CREDGEO X3T1CREDSTAT X3T1CREDTRIG X3T1CREDBIOL X3T1CREDCHEM X3T1CREDESCI X3T1CREDPHYS {
  replace `var' = . if `var' < 0
} 
summ X3T1CREDALG1 X3T1CREDALG2 X3T1CREDINTM X3T1CREDPREC X3T1CREDCALC X3T1CREDGEO X3T1CREDSTAT X3T1CREDTRIG X3T1CREDBIOL X3T1CREDCHEM X3T1CREDESCI X3T1CREDPHYS, sep(100)


foreach var of varlist X3TCREDAPMTH X3TCREDMAT X3TCREDAPSCI X3TCREDSCI X3TCREDMILSCI X3TCREDCOMPSCI X3TCREDMANU X3TCREDHELSCI X3TCREDARCH X3TCREDAG X3TCREDENGIN X3TCREDSTEM {
  replace `var' = . if `var' < 0
} 
summ X3TCREDAPMTH X3TCREDMAT X3TCREDAPSCI X3TCREDSCI X3TCREDMILSCI X3TCREDCOMPSCI X3TCREDMANU X3TCREDHELSCI X3TCREDARCH X3TCREDAG X3TCREDENGIN X3TCREDSTEM, sep(100)

*GPA
foreach var of varlist X3TGPAHIMTH X3TGPAMAT X3TGPAHISCI X3TGPASCI X3TGPAMILSCI X3TGPACOMPSCI X3TGPAMANU X3TGPAHELSCI X3TGPAARCH X3TGPAAG X3TGPAENGIN X3TGPASTEM {
  replace `var' = . if `var' < 0
} 
summ X3TGPAHIMTH X3TGPAMAT X3TGPAHISCI X3TGPASCI X3TGPAMILSCI X3TGPACOMPSCI X3TGPAMANU X3TGPAHELSCI X3TGPAARCH X3TGPAAG X3TGPAENGIN X3TGPASTEM, sep(100)

replace S3CLASSES = . if S3CLASSES == 3
replace S3CLASSES = 0 if S3CLASSES == 2


tab S3HSCREDTYPE, m
table S3HSCREDTYPE, c(freq mean S3CLASSES mean S3FIELD_STEM)

*Trichotomizing
foreach var of varlist  X3TCREDAPMTH X3TCREDMAT X3TCREDAPSCI X3TCREDSCI X3TCREDMILSCI X3TCREDCOMPSCI X3TCREDMANU X3TCREDHELSCI X3TCREDARCH X3TCREDAG X3TCREDENGIN X3TCREDSTEM /// 
  X3TGPAHIMTH X3TGPAMAT X3TGPAHISCI X3TGPASCI X3TGPAMILSCI X3TGPACOMPSCI X3TGPAMANU X3TGPAHELSCI X3TGPAARCH X3TGPAAG X3TGPAENGIN X3TGPASTEM ///
  X3THIMATH X3THIMATH9 X3TWHENALG1 X3THISCI X3THISCI9 X3THIBIO X3THICHEM X3THIPHY X3THIOTHSCI  {

  egen `var'_cut = cut(`var'), group(3)
  replace `var' = `var'_cut
  drop `var'_cut
  
  
}

keep X3TCREDAPMTH X3TCREDMAT X3TCREDAPSCI X3TCREDSCI X3TCREDMILSCI X3TCREDCOMPSCI X3TCREDMANU X3TCREDHELSCI X3TCREDARCH X3TCREDAG X3TCREDENGIN X3TCREDSTEM /// 
  X3TGPAHIMTH X3TGPAMAT X3TGPAHISCI X3TGPASCI X3TGPAMILSCI X3TGPACOMPSCI X3TGPAMANU X3TGPAHELSCI X3TGPAARCH X3TGPAAG X3TGPAENGIN X3TGPASTEM ///
  X3THIMATH X3THIMATH9 X3TWHENALG1 X3THISCI X3THISCI9 X3THIBIO X3THICHEM X3THIPHY X3THIOTHSCI ///
  X3T1CREDALG1 X3T1CREDALG2 X3T1CREDINTM X3T1CREDPREC X3T1CREDCALC X3T1CREDGEO X3T1CREDSTAT X3T1CREDTRIG X3T1CREDBIOL X3T1CREDCHEM X3T1CREDESCI X3T1CREDPHYS ///
  S3HSCREDTYPE S3CLASSES S3FIELD_STEM S3CLGFT S1M8 S1M8GRADE S1S8 S1S8GRADE ///
  S1ALG1M09 S1GEOM09 S1ALG2M09 S1TRIGM09 S1REVM09 S1INTGM109 S1STATSM09 S1INTGM209 S1PREALGM09 S1ANGEOM09 S1ADVM09 S1OTHM09 ///
  S1BIO1S09 S1EARTHS09 S1PHYSS09 S1ENVS09 S1PHYSIC1S09 S1INTGS1S09 S1CHEM1S09 S1INTGS2S09 S1ADVBIOS09 S1GENS09 S1LIFES09 S1ADVPHYSIC09 S1OTHENVS09 S1OTHBIOS09 S1OTHPHYS09 S1OTHS09 ///
  S2PREALGM12 S2ALG1M12 S2ALG2M12 S2ALG3M12 S2GEOM12 S2ANGEOM12 S2TRIGM12 S2PRECALC12 S2APCALC12 S2CALC12 S2APSTAT12 S2STAT12 S2INTGM112 S2INTGM212 S2INTGM312 S2REVIEWM12 S2LIFES12 S2BIO1S12 S2BIO2S12 S2APBIOS12 S2IBIOS12 S2ANATOMYS12 S2OTHBIOS12 S2CHEM1S12 S2CHEM2S12 S2APCHEM12 S2IBCHEM12 S2EARTHS12 S2APENVS12 S2OTHENVS12 S2PHYSIC1S12 S2PHYSIC2S12 S2APPHYSIC12 S2IBPHYSIC12 S2PHYSS12 S2OTHPHYS12 S2INTGS1S12 S2INTGS2S12 S2GENS12 S2COMPAPP12 S2COMPPROG12 S2APCOMPSCI12 S2OTHCOMP12 S2ENGINEER12 S2HIMATH12 S2HISCIENCE12 ///
  S2APMATH S2APSCIENCE S2IBMATH S2IBSCIENCE S2DUALMATH S2DUALSCIENCE 

*Imputing missing values
foreach var of varlist S3FIELD_STEM {
  replace `var' = 0 if mi(`var')
}
  
export delimited using "C:\Users\david_000\Google Drive\HSLS_2009_v3_0_Stata_Datasets\Cleaned HSLS 082717.csv", nolabel replace

